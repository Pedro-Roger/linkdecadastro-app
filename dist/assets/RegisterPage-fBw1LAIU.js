import{j as e}from"./index-BAEh9e7U.js";import{u as A,d as i,L as O}from"./react-vendor-40RSlyA9.js";import{u as D,o as M,s as n,e as G}from"./form-vendor-UKDbifrO.js";import{t as B}from"./zod-Bd6eNPbn.js";import{F as L}from"./Footer-BBQyibF0.js";import{M as U}from"./MobileNavbar-q4n5P1tP.js";import{a as I}from"./api-WS8dxZuR.js";import"./ui-vendor-CXsW6q1o.js";import"./NotificationBell-C7m-5Zbk.js";import"./utils-vendor-DwAQI6Fw.js";import"./useAuth-Dhb34Y_Y.js";const J=M({name:n().min(1,"Nome é obrigatório"),email:n().email("Email inválido"),password:n().min(6,"Senha deve ter no mínimo 6 caracteres"),cpf:n().min(11,"CPF deve ter 11 dígitos").max(11,"CPF deve ter 11 dígitos").regex(/^\d+$/,"CPF deve conter apenas números"),birthDate:n().min(1,"Data de nascimento é obrigatória"),participantType:G(["ESTUDANTE","PROFESSOR","PESQUISADOR","PRODUTOR"],{required_error:"Selecione o tipo de participante"}),hectares:n().optional().transform(r=>{if(!r||r.trim()==="")return;const m=parseFloat(r);return isNaN(m)?void 0:m}).refine(r=>r===void 0||r>0,{message:"Hectares deve ser um número positivo"}),state:n().min(2,"Estado é obrigatório"),city:n().min(1,"Cidade é obrigatória")}).refine(r=>r.participantType==="PRODUTOR"?r.hectares!==void 0&&r.hectares>0:!0,{message:"Hectares é obrigatório para produtores",path:["hectares"]});function Z(){const r=A(),[m,p]=i.useState(""),[u,x]=i.useState(!1),[S,c]=i.useState([]),[v,d]=i.useState([]),[N,h]=i.useState(!1),[b,f]=i.useState(!1),{register:o,handleSubmit:w,watch:y,setValue:g,formState:{errors:s}}=D({resolver:B(J)}),l=y("state"),R=y("participantType");i.useEffect(()=>{P()},[]),i.useEffect(()=>{l&&l.length===2?F(l):(d([]),g("city",""))},[l,g]);const P=async()=>{try{h(!0);const a=await fetch("https://servicodados.ibge.gov.br/api/v1/localidades/estados?orderBy=nome");if(a.ok){const t=await a.json();c(t)}else c([{sigla:"AC",nome:"Acre"},{sigla:"AL",nome:"Alagoas"},{sigla:"AP",nome:"Amapá"},{sigla:"AM",nome:"Amazonas"},{sigla:"BA",nome:"Bahia"},{sigla:"CE",nome:"Ceará"},{sigla:"DF",nome:"Distrito Federal"},{sigla:"ES",nome:"Espírito Santo"},{sigla:"GO",nome:"Goiás"},{sigla:"MA",nome:"Maranhão"},{sigla:"MT",nome:"Mato Grosso"},{sigla:"MS",nome:"Mato Grosso do Sul"},{sigla:"MG",nome:"Minas Gerais"},{sigla:"PA",nome:"Pará"},{sigla:"PB",nome:"Paraíba"},{sigla:"PR",nome:"Paraná"},{sigla:"PE",nome:"Pernambuco"},{sigla:"PI",nome:"Piauí"},{sigla:"RJ",nome:"Rio de Janeiro"},{sigla:"RN",nome:"Rio Grande do Norte"},{sigla:"RS",nome:"Rio Grande do Sul"},{sigla:"RO",nome:"Rondônia"},{sigla:"RR",nome:"Roraima"},{sigla:"SC",nome:"Santa Catarina"},{sigla:"SP",nome:"São Paulo"},{sigla:"SE",nome:"Sergipe"},{sigla:"TO",nome:"Tocantins"}])}catch{c([{sigla:"AC",nome:"Acre"},{sigla:"AL",nome:"Alagoas"},{sigla:"AP",nome:"Amapá"},{sigla:"AM",nome:"Amazonas"},{sigla:"BA",nome:"Bahia"},{sigla:"CE",nome:"Ceará"},{sigla:"DF",nome:"Distrito Federal"},{sigla:"ES",nome:"Espírito Santo"},{sigla:"GO",nome:"Goiás"},{sigla:"MA",nome:"Maranhão"},{sigla:"MT",nome:"Mato Grosso"},{sigla:"MS",nome:"Mato Grosso do Sul"},{sigla:"MG",nome:"Minas Gerais"},{sigla:"PA",nome:"Pará"},{sigla:"PB",nome:"Paraíba"},{sigla:"PR",nome:"Paraná"},{sigla:"PE",nome:"Pernambuco"},{sigla:"PI",nome:"Piauí"},{sigla:"RJ",nome:"Rio de Janeiro"},{sigla:"RN",nome:"Rio Grande do Norte"},{sigla:"RS",nome:"Rio Grande do Sul"},{sigla:"RO",nome:"Rondônia"},{sigla:"RR",nome:"Roraima"},{sigla:"SC",nome:"Santa Catarina"},{sigla:"SP",nome:"São Paulo"},{sigla:"SE",nome:"Sergipe"},{sigla:"TO",nome:"Tocantins"}])}finally{h(!1)}},F=async a=>{try{f(!0);const t=await fetch(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${a}/municipios`);if(t.ok){const E=(await t.json()).sort((T,C)=>T.nome.localeCompare(C.nome));d(E)}else d([])}catch{d([])}finally{f(!1)}},k=async a=>{p(""),x(!0);try{await I("/auth/register",{method:"POST",body:JSON.stringify({name:a.name,email:a.email,password:a.password,cpf:a.cpf.replace(/\D/g,""),birthDate:a.birthDate,participantType:a.participantType,hectares:a.participantType==="PRODUTOR"?a.hectares:void 0,state:a.state,city:a.city})}),r("/login?registered=true")}catch(t){p(t instanceof Error?t.message:"Erro ao cadastrar")}finally{x(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(U,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center py-12 px-4",children:e.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-lg p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-8 text-[#003366]",children:"Cadastrar"}),m&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:m}),e.jsxs("form",{onSubmit:w(k),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{...o("name"),type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"}),s.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"E-mail *"}),e.jsx("input",{...o("email"),type:"email",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"}),s.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha *"}),e.jsx("input",{...o("password"),type:"password",minLength:6,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Mínimo de 6 caracteres"}),s.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.password.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF *"}),e.jsx("input",{...o("cpf"),type:"text",maxLength:14,placeholder:"000.000.000-00",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900",onChange:a=>{const t=a.target.value.replace(/\D/g,""),j=t.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4");a.target.value=j,g("cpf",t,{shouldValidate:!0})}}),s.cpf&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.cpf.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Nascimento *"}),e.jsx("input",{...o("birthDate"),type:"date",max:new Date().toISOString().split("T")[0],className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"}),s.birthDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.birthDate.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 md:text-base",children:"Você é: *"}),e.jsxs("select",{...o("participantType"),className:"w-full px-4 py-3 text-base border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900 md:py-2 md:text-sm appearance-none bg-white cursor-pointer min-h-[48px] touch-manipulation",style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.75rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.5em 1.5em",paddingRight:"2.5rem"},children:[e.jsx("option",{value:"",children:"Selecione..."}),e.jsx("option",{value:"ESTUDANTE",children:"Estudante"}),e.jsx("option",{value:"PROFESSOR",children:"Professor"}),e.jsx("option",{value:"PESQUISADOR",children:"Pesquisador"}),e.jsx("option",{value:"PRODUTOR",children:"Produtor"})]}),s.participantType&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.participantType.message})]}),R==="PRODUTOR"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantos hectares você possui? *"}),e.jsx("input",{...o("hectares"),type:"number",step:"0.01",min:"0",placeholder:"Ex: 10.5",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"}),s.hectares&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.hectares.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 md:text-base",children:"Estado *"}),e.jsxs("select",{...o("state"),disabled:N,className:"w-full px-4 py-3 text-base border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900 disabled:opacity-50 md:py-2 md:text-sm appearance-none bg-white cursor-pointer min-h-[48px] touch-manipulation",style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.75rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.5em 1.5em",paddingRight:"2.5rem"},children:[e.jsx("option",{value:"",children:"Selecione o estado..."}),S.map(a=>e.jsx("option",{value:a.sigla,children:a.nome},a.sigla))]}),s.state&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.state.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 md:text-base",children:"Cidade *"}),e.jsxs("select",{...o("city"),disabled:!l||b,className:"w-full px-4 py-3 text-base border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900 disabled:opacity-50 md:py-2 md:text-sm appearance-none bg-white cursor-pointer min-h-[48px] touch-manipulation",style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.75rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.5em 1.5em",paddingRight:"2.5rem"},children:[e.jsx("option",{value:"",children:b?"Carregando...":l?"Selecione a cidade...":"Selecione o estado primeiro"}),v.map((a,t)=>e.jsx("option",{value:a.nome,children:a.nome},t))]}),s.city&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:s.city.message})]})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-[#FF6600] text-white py-3 px-6 rounded-md font-semibold hover:bg-[#e55a00] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Cadastrando...":"Cadastrar"})]}),e.jsxs("p",{className:"mt-6 text-center text-gray-600",children:["Já tem uma conta?"," ",e.jsx(O,{to:"/login",className:"text-[#FF6600] hover:underline",children:"Entrar"})]})]})}),e.jsx(L,{})]})}export{Z as default};
