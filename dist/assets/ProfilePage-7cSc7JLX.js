import{j as e,L as C}from"./index-CKd_6dCy.js";import{u as k,d as t,L as c}from"./react-vendor-40RSlyA9.js";import{u as A,o as E,s as d,l as L}from"./form-vendor-UKDbifrO.js";import{t as P}from"./zod-Bd6eNPbn.js";import{N as T}from"./NotificationBell-B3QQdthT.js";import{F as U}from"./Footer-CrxvJtYf.js";import{a as x}from"./api-WS8dxZuR.js";import{u as B}from"./useAuth-Dhb34Y_Y.js";import"./ui-vendor-CXsW6q1o.js";import"./utils-vendor-DwAQI6Fw.js";const M=E({name:d().min(1,"Nome é obrigatório"),email:d().email("Email inválido"),bio:d().max(500).optional(),avatar:d().url().optional().or(L(""))});function Q(){const u=k(),{loading:n,isAuthenticated:l,signOut:y}=B({requireAuth:!0,redirectTo:"/login"}),[r,h]=t.useState(null),[o,N]=t.useState(null),[p,b]=t.useState(!1),[v,m]=t.useState(!1),{register:i,handleSubmit:w,formState:{errors:a},reset:F}=A({resolver:P(M)});t.useEffect(()=>{!n&&!l&&u("/login")},[n,l,u]);const f=t.useCallback(async()=>{try{const s=await x("/user/profile",{auth:!0});h(s),F({name:s.name,email:s.email,bio:s.bio||"",avatar:s.avatar||""})}catch{}},[]),g=t.useCallback(async()=>{try{const s=await x("/user/stats",{auth:!0});N(s)}catch{}},[]);t.useEffect(()=>{l&&(f(),g())},[l,f,g]);const S=async s=>{b(!0),m(!1);try{const j=await x("/user/profile",{method:"PATCH",auth:!0,body:JSON.stringify(s)});h(j),m(!0),setTimeout(()=>m(!1),3e3)}catch{}finally{b(!1)}};return n||!r?e.jsx(C,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:e.jsx("div",{className:"container mx-auto px-4 py-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-2 md:space-y-0",children:[e.jsx(c,{to:"/",className:"flex items-center",children:e.jsx("img",{src:"/logo B.png",alt:"Link de Cadastro",className:"h-20 md:h-24 w-auto object-contain"})}),e.jsxs("nav",{className:"flex items-center space-x-4 md:space-x-6 text-sm md:text-base",children:[e.jsx(c,{to:"/courses",className:"text-gray-700 hover:text-[#FF6600]",children:"Cursos"}),e.jsx(c,{to:"/my-courses",className:"text-gray-700 hover:text-[#FF6600]",children:"Meus Cursos"}),e.jsx(T,{}),e.jsx(c,{to:"/profile",className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-[#FF6600] text-white font-bold flex items-center justify-center",children:r.name.charAt(0).toUpperCase()}),e.jsx("button",{onClick:()=>y(),className:"bg-red-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-red-600 transition-colors text-sm md:text-base",children:"Sair"})]})]})})}),e.jsxs("div",{className:"container mx-auto px-4 py-8 pb-24 md:pb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-[#003366]",children:"Meu Perfil"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col items-center mb-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-[#FF6600] text-white flex items-center justify-center text-2xl font-bold mb-3",children:r.name.charAt(0).toUpperCase()}),e.jsx("h2",{className:"text-xl font-semibold text-[#003366]",children:r.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:r.email})]}),o&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-[#FF6600]",children:o.coursesEnrolled}),e.jsx("div",{className:"text-sm text-gray-600",children:"Cursos Inscritos"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-[#FF6600]",children:o.lessonsCompleted}),e.jsx("div",{className:"text-sm text-gray-600",children:"Aulas Concluídas"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-[#FF6600]",children:[o.totalProgress,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Progresso Médio"})]})]})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-[#003366]",children:"Editar Perfil"}),v&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded mb-4",children:"Perfil atualizado com sucesso!"}),e.jsxs("form",{onSubmit:w(S),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{...i("name"),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"}),a.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"E-mail *"}),e.jsx("input",{type:"email",...i("email"),disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"O e-mail não pode ser alterado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL do Avatar (opcional)"}),e.jsx("input",{type:"url",...i("avatar"),placeholder:"https://exemplo.com/avatar.jpg",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"}),a.avatar&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.avatar.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio (opcional)"}),e.jsx("textarea",{...i("bio"),rows:4,maxLength:500,placeholder:"Conte um pouco sobre você...",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"}),a.bio&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.bio.message})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full bg-[#FF6600] text-white py-3 px-6 rounded-md font-semibold hover:bg-[#e55a00] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Salvando...":"Salvar Alterações"})]})]})})]})]}),e.jsx(U,{})]})}export{Q as default};
