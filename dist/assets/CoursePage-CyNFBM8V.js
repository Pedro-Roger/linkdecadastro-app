import{j as e,L as Z}from"./index-CswzOF3x.js";import{i as z,u as J,d as r,L as c}from"./react-vendor-40RSlyA9.js";import{R as V}from"./youtube-Caw7YJqk.js";import{N as _,p as q}from"./NotificationBell-Dj7Rk7Dl.js";import{F as G}from"./Footer-iGY0art6.js";import{a as m,n as L}from"./api-cc_Vofyw.js";import{a as H}from"./utils-vendor-DwAQI6Fw.js";import"./ui-vendor-VWVTWWFz.js";function re(){const M=z(),b=J(),x=M.courseId,[t,$]=r.useState(null),[a,j]=r.useState(null),[h,y]=r.useState([]),[u,v]=r.useState(""),[N,w]=r.useState(!1),[A,P]=r.useState(null),[T,U]=r.useState(!0),[B,C]=r.useState(!1),[D,d]=r.useState("idle"),p=r.useCallback(async()=>{try{const s=await m(`/courses/${x}`,{auth:!0});$(s),s.lessons&&s.lessons.length>0&&j(s.lessons[0])}catch{}finally{U(!1)}},[x]),k=r.useCallback(async()=>{if(a)try{const s=await m(`/lessons/${a.id}/comments`);y(s)}catch{}},[a]),g=r.useCallback(async()=>{if(a)try{const s=await m(`/lessons/${a.id}/progress`,{auth:!0});P(s)}catch{}},[a]);r.useEffect(()=>{if(!(typeof window<"u"?localStorage.getItem("token"):null)){b("/login");return}x&&p()},[x,p,b]),r.useEffect(()=>{a&&(k(),g())},[a,k,g]);const E=async s=>{if(!a)return;const o=Math.floor(s.playedSeconds),l=s.played>=.9;try{await m(`/lessons/${a.id}/progress`,{method:"POST",auth:!0,body:JSON.stringify({watchedTime:o,completed:l})}),l&&!A?.completed&&(g(),p())}catch{}},n=r.useMemo(()=>{if(!t)return null;const s=typeof window<"u"?window.location.origin:"",o=t.slug?`/enroll.html?course=${t.slug}`:`/enroll.html?course=${t.id}`,l=s?`${s}${o}`:o;let i=t.bannerUrl;i&&(i=L(i));const f=`Confira o curso "${t.title}" no Link de Cadastro: ${l}`;return{url:l,bannerUrl:i,message:f}},[t]),O=r.useCallback(async()=>{if(!n||!t)return;const s={title:t.title,text:`Confira o curso "${t.title}" no Link de Cadastro.`,url:n.url};try{typeof navigator<"u"&&navigator.share?await navigator.share(s):typeof navigator<"u"&&navigator.clipboard?.writeText&&(await navigator.clipboard.writeText(n.message),d("success"),setTimeout(()=>d("idle"),2e3))}catch{}},[n,t]),R=r.useCallback(()=>{if(!n||!t)return;const s=`${t.title}${t.description?`

${t.description.substring(0,150)}${t.description.length>150?"...":""}`:""}

${n.url}`,o=`https://wa.me/?text=${encodeURIComponent(s)}`;typeof window<"u"&&window.open(o,"_blank","noopener,noreferrer")},[n,t]),I=r.useCallback(async()=>{if(n)try{typeof navigator<"u"&&navigator.clipboard?.writeText&&(await navigator.clipboard.writeText(n.url),d("success"),setTimeout(()=>d("idle"),2e3))}catch{}},[n]),S=r.useCallback(()=>{d("idle"),C(!0)},[]),F=r.useCallback(()=>{C(!1)},[]),W=async s=>{if(s.preventDefault(),!(!u.trim()||!a)){w(!0);try{const o=await m(`/lessons/${a.id}/comments`,{method:"POST",auth:!0,body:JSON.stringify({content:u})});y([o,...h]),v("")}catch{}finally{w(!1)}}};return T?e.jsx(Z,{}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:e.jsx("div",{className:"container mx-auto px-4 py-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-2 md:space-y-0",children:[e.jsx(c,{to:"/",className:"flex items-center",children:e.jsx("img",{src:"/logo B.png",alt:"Link de Cadastro",className:"h-20 md:h-24 w-auto object-contain"})}),e.jsxs("nav",{className:"flex items-center space-x-4 md:space-x-6 text-sm md:text-base",children:[e.jsx(c,{to:"/courses",className:"text-gray-700 hover:text-[#FF6600]",children:"Cursos"}),e.jsx(c,{to:"/my-courses",className:"text-gray-700 hover:text-[#FF6600]",children:"Meus Cursos"}),e.jsx(_,{}),e.jsx(c,{to:"/profile",className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-[#FF6600] text-white font-bold flex items-center justify-center",children:"A"})]})]})})}),e.jsx("div",{className:"bg-gray-100 py-2",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("nav",{className:"text-xs md:text-sm text-gray-600",children:[e.jsx(c,{to:"/courses",className:"hover:text-[#FF6600]",children:"Cursos"})," / ",e.jsx(c,{to:"/my-courses",className:"hover:text-[#FF6600]",children:"Meus Cursos"})," / ",e.jsx("span",{className:"text-gray-900",children:t.title})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-4 md:py-6",children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-[#003366] mb-2",children:t.title}),t.description&&e.jsx("p",{className:"text-gray-600 text-sm md:text-base",children:t.description})]}),e.jsxs("div",{className:"flex flex-none items-center gap-3",children:[e.jsxs("button",{onClick:S,className:"inline-flex items-center gap-2 bg-[#FF6600] text-white px-4 py-2 rounded-md font-semibold hover:bg-[#e55a00] transition-colors",children:[e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12a9 9 0 11-6.219-8.56"})}),"Compartilhar"]}),e.jsxs("button",{onClick:S,className:"inline-flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-md font-semibold hover:bg-green-700 transition-colors",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20.52 3.48A11.77 11.77 0 0 0 12.02 0 11.84 11.84 0 0 0 .15 11.85a11.6 11.6 0 0 0 1.58 5.84L0 24l6.42-1.68a11.85 11.85 0 0 0 5.6 1.42h.01A11.84 11.84 0 0 0 24 11.86a11.7 11.7 0 0 0-3.48-8.38ZM12 21.15h-.01a9.9 9.9 0 0 1-5.04-1.38l-.36-.21-3.81.99 1.02-3.7-.23-.38a9.84 9.84 0 0 1 8.43-15.1h.01a9.8 9.8 0 0 1 9.82 9.84A9.86 9.86 0 0 1 12 21.15Zm5.41-7.36c-.3-.15-1.77-.87-2.04-.97s-.47-.15-.66.15-.76.97-.93 1.17-.34.22-.63.07a8.07 8.07 0 0 1-2.37-1.46 8.84 8.84 0 0 1-1.62-2 1.77 1.77 0 0 1 .11-1.86c.18-.23.4-.48.6-.73s.25-.38.37-.62.06-.45 0-.62-.66-1.59-.91-2.18-.5-.5-.68-.51h-.58a1.12 1.12 0 0 0-.81.38 3.36 3.36 0 0 0-1.06 2.5 5.86 5.86 0 0 0 1.24 3.13 13.35 13.35 0 0 0 5.15 4.52 5.9 5.9 0 0 0 2.4.73 2 2 0 0 0 1.31-.86 1.6 1.6 0 0 0 .11-.86c-.05-.09-.27-.17-.57-.31Z"})}),"WhatsApp"]})]})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-4 md:py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 md:gap-8",children:[e.jsx("div",{className:"lg:col-span-1 order-2 lg:order-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[e.jsx("h3",{className:"text-base md:text-lg font-semibold mb-4 text-[#003366]",children:"Aulas do Curso"}),e.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:t.lessons?.map((s,o)=>{const i=t.enrollment?.course?.lessons?.find(f=>f.id===s.id)?.progress?.[0]?.completed||!1;return e.jsx("button",{onClick:()=>j(s),className:`w-full text-left p-2 md:p-3 rounded-lg transition-colors text-sm md:text-base ${a?.id===s.id?"bg-[#FF6600] text-white":"bg-gray-50 hover:bg-gray-100 text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0 ${a?.id===s.id?"bg-white text-[#FF6600]":i?"bg-green-500 text-white":"bg-[#FF6600] text-white"}`,children:i?"✓":o+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:s.title}),s.duration&&e.jsx("div",{className:"text-xs opacity-75",children:s.duration})]})]})},s.id)})}),e.jsxs("div",{className:"mt-4 md:mt-6 pt-4 md:pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-xs md:text-sm font-semibold mb-3 text-[#003366]",children:"Informações do Curso"}),e.jsxs("div",{className:"space-y-2 text-xs md:text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Data:"})," 22/04/2024"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Local:"})," Recife - PE"]}),e.jsx("div",{children:e.jsx("span",{className:"inline-block px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"Em Andamento"})})]})]})]})}),e.jsxs("div",{className:"lg:col-span-3 order-1 lg:order-2 space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a?.videoUrl?e.jsx("div",{className:"aspect-video bg-black",children:e.jsx(V,{url:a.videoUrl,width:"100%",height:"100%",controls:!0,onProgress:E})}):e.jsx("div",{className:"aspect-video bg-gray-200 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum vídeo disponível"})}),e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-2 text-[#003366]",children:a?.title||"Selecione uma aula"}),a?.duration&&e.jsxs("p",{className:"text-gray-600 mb-4 text-sm md:text-base",children:["Duração: ",a.duration]}),a?.description&&e.jsx("p",{className:"text-gray-700 text-sm md:text-base",children:a.description})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[e.jsxs("h3",{className:"text-lg md:text-xl font-semibold mb-4 text-[#003366]",children:["Comentários (",h.length,")"]}),e.jsxs("form",{onSubmit:W,className:"mb-6",children:[e.jsx("textarea",{value:u,onChange:s=>v(s.target.value),placeholder:"Deixe seu comentário sobre esta aula...",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-sm md:text-base"}),e.jsx("button",{type:"submit",disabled:N||!u.trim(),className:"mt-2 bg-[#FF6600] text-white px-4 py-2 rounded-md font-semibold hover:bg-[#e55a00] transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm md:text-base",children:N?"Enviando...":"Comentar"})]}),e.jsxs("div",{className:"space-y-4",children:[h.map(s=>e.jsx("div",{className:"border-b border-gray-200 pb-4 last:border-0",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-[#FF6600] text-white flex items-center justify-center font-bold text-sm md:text-base",children:s.user.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-[#003366] text-sm md:text-base",children:s.user.name}),e.jsx("span",{className:"text-xs md:text-sm text-gray-500",children:H(new Date(s.createdAt),{addSuffix:!0,locale:q})})]}),e.jsx("p",{className:"text-gray-700 text-sm md:text-base whitespace-pre-wrap break-words",children:s.content})]})]})},s.id)),h.length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8 text-sm md:text-base",children:"Nenhum comentário ainda. Seja o primeiro a comentar!"})]})]})]})]})}),B&&n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4 py-6",children:e.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-[#003366]",children:"Compartilhar curso"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Revise como o link aparecerá antes de enviar"})]}),e.jsx("button",{onClick:F,className:"text-gray-400 transition-colors hover:text-gray-600",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid gap-4 px-6 py-4 md:grid-cols-[160px,1fr]",children:[e.jsx("div",{className:"flex items-center justify-center",children:n.bannerUrl?e.jsx("img",{src:L(n.bannerUrl),alt:`Banner do curso ${t.title}`,className:"h-32 w-32 rounded-lg object-cover shadow-sm",referrerPolicy:"no-referrer"}):e.jsx("div",{className:"flex h-32 w-32 items-center justify-center rounded-lg bg-gradient-to-br from-[#003366] to-[#FF6600] text-center text-xs font-semibold text-white",children:"Sem banner"})}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-[#003366]",children:t.title}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-gray-600 line-clamp-3",children:t.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Link do curso"}),e.jsxs("div",{className:"mt-1 grid grid-cols-[1fr,auto] gap-2 overflow-hidden rounded-lg border border-gray-200 bg-gray-50",children:[e.jsx("input",{readOnly:!0,value:n.url,className:"truncate bg-transparent px-3 py-2 text-sm text-gray-700 outline-none"}),e.jsx("button",{onClick:I,className:"m-1 flex items-center justify-center rounded-md bg-white px-3 text-xs font-semibold text-[#003366] transition-colors hover:bg-gray-100",children:D==="success"?"Copiado!":"Copiar"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 border-t bg-gray-50 px-6 py-4 md:flex-row md:justify-end",children:[e.jsxs("button",{onClick:O,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-[#003366] px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-[#00264d]",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12v.01M12 12v.01M20 12v.01M7 12a5 5 0 0110 0"})}),"Compartilhar agora"]}),e.jsxs("button",{onClick:R,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-green-700",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20.52 3.48A11.77 11.77 0 0 0 12.02 0 11.84 11.84 0 0 0 .15 11.85a11.6 11.6 0 0 0 1.58 5.84L0 24l6.42-1.68a11.85 11.85 0 0 0 5.6 1.42h.01A11.84 11.84 0 0 0 24 11.86a11.7 11.7 0 0 0-3.48-8.38ZM12 21.15h-.01a9.9 9.9 0 0 1-5.04-1.38l-.36-.21-3.81.99 1.02-3.7-.23-.38a9.84 9.84 0 0 1 8.43-15.1h.01a9.8 9.8 0 0 1 9.82 9.84A9.86 9.86 0 0 1 12 21.15Zm5.41-7.36c-.3-.15-1.77-.87-2.04-.97s-.47-.15-.66.15-.76.97-.93 1.17-.34.22-.63.07a8.07 8.07 0 0 1-2.37-1.46 8.84 8.84 0 0 1-1.62-2 1.77 1.77 0 0 1 .11-1.86c.18-.23.4-.48.6-.73s.25-.38.37-.62.06-.45 0-.62-.66-1.59-.91-2.18-.5-.5-.68-.51h-.58a1.12 1.12 0 0 0-.81.38 3.36 3.36 0 0 0-1.06 2.5 5.86 5.86 0 0 0 1.24 3.13 13.35 13.35 0 0 0 5.15 4.52 5.9 5.9 0 0 0 2.4.73 2 2 0 0 0 1.31-.86 1.6 1.6 0 0 0 .11-.86c-.05-.09-.27-.17-.57-.31Z"})}),"WhatsApp"]}),e.jsx("button",{onClick:F,className:"inline-flex items-center justify-center gap-2 rounded-lg border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-600 transition-colors hover:bg-gray-100",children:"Fechar"})]})]})}),e.jsx(G,{})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-xl",children:"Curso não encontrado"})})}export{re as default};
