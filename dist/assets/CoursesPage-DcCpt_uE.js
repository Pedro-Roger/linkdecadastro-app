import{u as P,j as e,L as _}from"./index-DME__o-_.js";import{u as q,d as l,L as p}from"./react-vendor-40RSlyA9.js";import{M as G}from"./MobileNavbar-BZWej50p.js";import{F as H}from"./Footer-CSK2wk4J.js";import{a as E,n as y,g as A}from"./api-cc_Vofyw.js";import"./ui-vendor-VWVTWWFz.js";import"./NotificationBell-BCWVJRtn.js";import"./utils-vendor-DwAQI6Fw.js";function ae(){const w=q(),{user:N,loading:f,isAuthenticated:b}=P({requireAuth:!0,redirectTo:"/login"}),[v,M]=l.useState([]),[D,T]=l.useState(!0),[j,S]=l.useState(""),[c,x]=l.useState("all"),[U,C]=l.useState(!1),[I,m]=l.useState("idle"),[o,B]=l.useState(null);l.useEffect(()=>{f||(!b||N?.role!=="ADMIN"?w("/my-courses"):k())},[f,b,N,w]);async function k(){try{const t=await E("/admin/courses",{auth:!0});M(t)}catch{}finally{T(!1)}}const V=async(t,r)=>{if(confirm(`Tem certeza que deseja excluir o curso "${r}"? Esta ação não pode ser desfeita.`))try{await E(`/admin/courses/${t}`,{method:"DELETE",auth:!0}),k(),alert("Curso excluído com sucesso!")}catch{alert("Erro ao excluir curso")}},W=async(t,r)=>{try{const s=typeof window<"u"?localStorage.getItem("token"):null;if(!s){alert("Você precisa estar logado para exportar dados");return}const n=`${A()}/admin/courses/${t}/export?format=xlsx`;console.log("Exportando para:",n);const a=await fetch(n,{method:"GET",headers:{Authorization:`Bearer ${s}`}});if(console.log("Resposta do export:",a.status,a.statusText),a.ok){const h=await a.blob(),d=window.URL.createObjectURL(h),g=document.createElement("a");g.href=d,g.download=`inscritos-${r.replace(/[^a-z0-9]/gi,"-").toLowerCase()}.xlsx`,document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(d),document.body.removeChild(g)}else{const h=await a.text();console.error("Erro ao exportar:",h),alert(`Erro ao exportar dados: ${a.status} ${a.statusText}`)}}catch(s){console.error("Erro ao exportar:",s),alert(`Erro ao exportar dados: ${s instanceof Error?s.message:"Erro desconhecido"}`)}},z=t=>{const r=typeof window<"u"?window.location.origin:"",s=A(),n=t.slug?`/enroll.html?course=${t.slug}`:`/enroll.html?course=${t.id}`,a=r?`${r}${n}`:n,h=t.slug?`${s}/share/enroll/${t.slug}`:`${s}/share/enroll/${t.id}`;let d=t.bannerUrl;return d&&(d=y(d)),{url:a,ogUrl:h,bannerUrl:d,message:`Confira o curso "${t.title}" no Link de Cadastro: ${a}`}},i=l.useMemo(()=>o?z(o):null,[o]),$=t=>{B(t),m("idle"),C(!0)},L=()=>{C(!1)},R=async()=>{if(i)try{typeof navigator<"u"&&navigator.clipboard?.writeText&&(await navigator.clipboard.writeText(i.url),m("success"),setTimeout(()=>m("idle"),2e3))}catch{}},Z=async()=>{if(!o||!i)return;const t={title:o.title,text:`Confira o curso "${o.title}" no Link de Cadastro.`,url:i.ogUrl||i.url};try{typeof navigator<"u"&&navigator.share?await navigator.share(t):typeof navigator<"u"&&navigator.clipboard?.writeText&&(await navigator.clipboard.writeText(i.message),m("success"),setTimeout(()=>m("idle"),2e3))}catch{}},O=()=>{if(!i||!o)return;const t=i.ogUrl||i.url,r=`${o.title}${o.description?`

${o.description.substring(0,150)}${o.description.length>150?"...":""}`:""}

${t}`,s=`https://wa.me/?text=${encodeURIComponent(r)}`;typeof window<"u"&&window.open(s,"_blank","noopener,noreferrer")},F=(()=>{let t=[...v];if(c!=="all"){const r=new Date;t=t.filter(s=>{const n=s.startDate?new Date(s.startDate):null,a=s.endDate?new Date(s.endDate):null;switch(c){case"active":return s.status==="ACTIVE";case"inactive":return s.status==="INACTIVE";case"available":return!n||n>=r||n<=r&&(!a||a>=r);case"ongoing":return n&&n<=r&&(!a||a>=r);case"closed":return a&&a<r;default:return!0}})}if(j){const r=j.toLowerCase();t=t.filter(s=>s.title.toLowerCase().includes(r)||s.description?.toLowerCase().includes(r))}return t})(),u=t=>{const r=new Date;return v.filter(s=>{const n=s.startDate?new Date(s.startDate):null,a=s.endDate?new Date(s.endDate):null;switch(t){case"active":return s.status==="ACTIVE";case"inactive":return s.status==="INACTIVE";case"available":return!n||n>=r||n<=r&&(!a||a>=r);case"ongoing":return n&&n<=r&&(!a||a>=r);case"closed":return a&&a<r;default:return!0}}).length};return f||D?e.jsx(_,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(G,{}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"relative max-w-2xl mx-auto",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Pesquisar cursos por nome, descrição...",value:j,onChange:t=>S(t.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#FF6600] focus:border-transparent text-gray-900"})]})})}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[e.jsxs("button",{onClick:()=>x("all"),className:`px-4 py-2 rounded-full font-medium transition-colors ${c==="all"?"bg-[#FF6600] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Todos (",v.length,")"]}),e.jsxs("button",{onClick:()=>x("active"),className:`px-4 py-2 rounded-full font-medium transition-colors ${c==="active"?"bg-[#FF6600] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Ativos (",u("active"),")"]}),e.jsxs("button",{onClick:()=>x("inactive"),className:`px-4 py-2 rounded-full font-medium transition-colors ${c==="inactive"?"bg-[#FF6600] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Inativos (",u("inactive"),")"]}),e.jsxs("button",{onClick:()=>x("available"),className:`px-4 py-2 rounded-full font-medium transition-colors ${c==="available"?"bg-[#FF6600] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Disponíveis (",u("available"),")"]}),e.jsxs("button",{onClick:()=>x("ongoing"),className:`px-4 py-2 rounded-full font-medium transition-colors ${c==="ongoing"?"bg-[#FF6600] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Em Andamento (",u("ongoing"),")"]}),e.jsxs("button",{onClick:()=>x("closed"),className:`px-4 py-2 rounded-full font-medium transition-colors ${c==="closed"?"bg-[#FF6600] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Encerrados (",u("closed"),")"]})]})})}),e.jsxs("div",{className:"container mx-auto px-4 py-8 pb-24 md:pb-8 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#003366] mb-2",children:"Cursos Disponíveis"}),e.jsx("p",{className:"text-gray-600",children:"Gerenciamento e moderação de cursos"})]}),e.jsx(p,{to:"/admin/courses/new",className:"bg-[#FF6600] text-white px-6 py-3 rounded-md font-semibold hover:bg-[#e55a00] transition-colors",children:"+ Novo Curso"})]}),F.length===0?e.jsxs("div",{className:"text-center py-24",children:[e.jsx("p",{className:"text-gray-500 text-lg mb-4",children:"Nenhum curso encontrado."}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Tente ajustar os filtros ou a busca."}),e.jsx(p,{to:"/admin/courses/new",className:"inline-block bg-[#FF6600] text-white px-6 py-3 rounded-md font-semibold hover:bg-[#e55a00] transition-colors",children:"Criar Primeiro Curso"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:F.map(t=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:[t.bannerUrl&&t.bannerUrl.trim()?e.jsx("div",{className:"relative w-full h-[386px] overflow-hidden bg-gray-200",children:e.jsx("img",{src:y(t.bannerUrl),alt:`Banner do curso ${t.title}`,className:"w-full h-full min-w-full min-h-full object-cover",style:{objectFit:"cover",objectPosition:"center"},onError:r=>{r.currentTarget.style.display="none"}})}):e.jsx("div",{className:"w-full h-[336px] bg-gradient-to-br from-[#003366] to-[#FF6600] flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:"Sem banner"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.status==="ACTIVE"?"Ativo":"Inativo"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2 text-[#003366]",children:t.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between mb-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[t.lessons?.length||0," aulas"]}),e.jsxs("span",{children:[t._count?.enrollments||0," alunos"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{to:`/admin/courses/${t.id}/lessons`,className:"block w-full bg-[#FF6600] text-white py-2 px-4 rounded-md font-semibold hover:bg-[#e55a00] transition-colors text-center text-sm",children:"Gerenciar Aulas"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-2",children:[e.jsxs(p,{to:`/admin/courses/${t.id}/enrollments`,className:"bg-blue-600 text-white py-2 px-3 rounded-md font-semibold hover:bg-blue-700 transition-colors text-center text-xs",children:["Inscritos (",t._count?.enrollments||0,")"]}),e.jsxs("button",{onClick:()=>W(t.id,t.title),className:"bg-green-600 text-white py-2 px-3 rounded-md font-semibold hover:bg-green-700 transition-colors text-xs flex items-center justify-center gap-1",disabled:!t._count?.enrollments||t._count.enrollments===0,children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Excel"]}),e.jsxs("button",{onClick:()=>$(t),className:"bg-[#003366] text-white py-2 px-3 rounded-md font-semibold hover:bg-[#00264d] transition-colors text-xs flex items-center justify-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12v.01M12 12v.01M20 12v.01M7 12a5 5 0 0110 0"})}),"Compartilhar"]}),e.jsxs("button",{onClick:()=>$(t),className:"bg-green-600 text-white py-2 px-3 rounded-md font-semibold hover:bg-green-700 transition-colors text-xs flex items-center justify-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20.52 3.48A11.77 11.77 0 0 0 12.02 0 11.84 11.84 0 0 0 .15 11.85a11.6 11.6 0 0 0 1.58 5.84L0 24l6.42-1.68a11.85 11.85 0 0 0 5.6 1.42h.01A11.84 11.84 0 0 0 24 11.86a11.7 11.7 0 0 0-3.48-8.38ZM12 21.15h-.01a9.9 9.9 0 0 1-5.04-1.38l-.36-.21-3.81.99 1.02-3.7-.23-.38a9.84 9.84 0 0 1 8.43-15.1h.01a9.8 9.8 0 0 1 9.82 9.84A9.86 9.86 0 0 1 12 21.15Zm5.41-7.36c-.3-.15-1.77-.87-2.04-.97s-.47-.15-.66.15-.76.97-.93 1.17-.34.22-.63.07a8.07 8.07 0 0 1-2.37-1.46 8.84 8.84 0 0 1-1.62-2 1.77 1.77 0 0 1 .11-1.86c.18-.23.4-.48.6-.73s.25-.38.37-.62.06-.45 0-.62-.66-1.59-.91-2.18-.5-.5-.68-.51h-.58a1.12 1.12 0 0 0-.81.38 3.36 3.36 0 0 0-1.06 2.5 5.86 5.86 0 0 0 1.24 3.13 13.35 13.35 0 0 0 5.15 4.52 5.9 5.9 0 0 0 2.4.73 2 2 0 0 0 1.31-.86 1.6 1.6 0 0 0 .11-.86c-.05-.09-.27-.17-.57-.31Z"})}),"WhatsApp"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(p,{to:`/admin/courses/new?clone=${t.id}`,className:"bg-purple-600 text-white py-2 px-4 rounded-md font-semibold hover:bg-purple-700 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Clonar"]}),e.jsxs("button",{onClick:()=>V(t.id,t.title),className:"bg-red-600 text-white py-2 px-4 rounded-md font-semibold hover:bg-red-700 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Excluir"]})]})]})]})]},t.id))})]}),U&&o&&i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4 py-6",children:e.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-white shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-[#003366]",children:"Compartilhar curso"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Revise as informações antes de enviar"})]}),e.jsx("button",{onClick:L,className:"text-gray-400 transition-colors hover:text-gray-600",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid gap-4 px-6 py-4 md:grid-cols-[160px,1fr]",children:[e.jsx("div",{className:"flex items-center justify-center",children:i.bannerUrl?e.jsx("img",{src:y(i.bannerUrl),alt:`Banner do curso ${o.title}`,className:"h-32 w-32 rounded-lg object-cover shadow-sm",referrerPolicy:"no-referrer"}):e.jsx("div",{className:"flex h-32 w-32 items-center justify-center rounded-lg bg-gradient-to-br from-[#003366] to-[#FF6600] text-center text-xs font-semibold text-white",children:"Sem banner"})}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-[#003366]",children:o.title}),o.description&&e.jsx("p",{className:"mt-1 text-sm text-gray-600 line-clamp-3",children:o.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Link do curso"}),e.jsxs("div",{className:"mt-1 grid grid-cols-[1fr,auto] gap-2 overflow-hidden rounded-lg border border-gray-200 bg-gray-50",children:[e.jsx("input",{readOnly:!0,value:i.url,className:"truncate bg-transparent px-3 py-2 text-sm text-gray-700 outline-none"}),e.jsx("button",{onClick:R,className:"m-1 flex items-center justify-center rounded-md bg-white px-3 text-xs font-semibold text-[#003366] transition-colors hover:bg-gray-100",children:I==="success"?"Copiado!":"Copiar"})]})]}),i.bannerUrl&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"Imagem do curso"}),e.jsx("div",{className:"mt-1 truncate rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-sm text-gray-700",children:i.bannerUrl})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 border-t bg-gray-50 px-6 py-4 md:flex-row md:justify-end",children:[e.jsxs("button",{onClick:Z,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-[#003366] px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-[#00264d]",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12v.01M12 12v.01M20 12v.01M7 12a5 5 0 0110 0"})}),"Compartilhar agora"]}),e.jsxs("button",{onClick:O,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-green-700",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20.52 3.48A11.77 11.77 0 0 0 12.02 0 11.84 11.84 0 0 0 .15 11.85a11.6 11.6 0 0 0 1.58 5.84L0 24l6.42-1.68a11.85 11.85 0 0 0 5.6 1.42h.01A11.84 11.84 0 0 0 24 11.86a11.7 11.7 0 0 0-3.48-8.38ZM12 21.15h-.01a9.9 9.9 0 0 1-5.04-1.38l-.36-.21-3.81.99 1.02-3.7-.23-.38a9.84 9.84 0 0 1 8.43-15.1h.01a9.8 9.8 0 0 1 9.82 9.84A9.86 9.86 0 0 1 12 21.15Zm5.41-7.36c-.3-.15-1.77-.87-2.04-.97s-.47-.15-.66.15-.76.97-.93 1.17-.34.22-.63.07a8.07 8.07 0 0 1-2.37-1.46 8.84 8.84 0 0 1-1.62-2 1.77 1.77 0 0 1 .11-1.86c.18-.23.4-.48.6-.73s.25-.38.37-.62.06-.45 0-.62-.66-1.59-.91-2.18-.5-.5-.68-.51h-.58a1.12 1.12 0 0 0-.81.38 3.36 3.36 0 0 0-1.06 2.5 5.86 5.86 0 0 0 1.24 3.13 13.35 13.35 0 0 0 5.15 4.52 5.9 5.9 0 0 0 2.4.73 2 2 0 0 0 1.31-.86 1.6 1.6 0 0 0 .11-.86c-.05-.09-.27-.17-.57-.31Z"})}),"WhatsApp"]}),e.jsx("button",{onClick:L,className:"inline-flex items-center justify-center gap-2 rounded-lg border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-600 transition-colors hover:bg-gray-100",children:"Fechar"})]})]})}),e.jsx(H,{}),b&&e.jsx("div",{className:"md:hidden h-20"})]})}export{ae as default};
