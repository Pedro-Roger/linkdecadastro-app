import{j as e}from"./index-PpJsr2Wq.js";import{u as k,h as C,d as o,L as r}from"./react-vendor-zMYjrXeL.js";import{N as F,p as E}from"./NotificationBell-Dqad17E3.js";import{F as L}from"./Footer-BQYOFbJ5.js";import{a as g,g as A}from"./api-BXcTEOQy.js";import{u as D}from"./useAuth-Ck1ucCrv.js";import{f as S}from"./utils-vendor-DwAQI6Fw.js";import"./ui-vendor-CXRLlFQf.js";function O(){const x=k(),{user:c,loading:l,isAuthenticated:m,signOut:f}=D({requireAuth:!0,redirectTo:"/login"}),s=C().courseId,[i,y]=o.useState([]),[d,j]=o.useState(null),[N,w]=o.useState(!0),h=o.useCallback(async()=>{try{const[t,a]=await Promise.all([g(`/admin/courses/${s}/enrollments`,{auth:!0}),g(`/admin/courses/${s}`,{auth:!0})]);y(t),j(a)}catch{}finally{w(!1)}},[s]);o.useEffect(()=>{l||(!m||c?.role!=="ADMIN"?x("/my-courses"):s&&h())},[l,m,c,s,h,x]);const b=async()=>{try{const t=`${A()}/admin/courses/${s}/export`,a=typeof window<"u"?localStorage.getItem("token"):null,p=await fetch(t,{headers:a?{Authorization:`Bearer ${a}`}:void 0});if(p.ok){const v=await p.blob(),u=window.URL.createObjectURL(v),n=document.createElement("a");n.href=u,n.download=`inscritos-${d?.title?.replace(/[^a-z0-9]/gi,"-").toLowerCase()||"curso"}.xlsx`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(u),document.body.removeChild(n)}else alert("Erro ao exportar dados")}catch{alert("Erro ao exportar dados")}};return l||N?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-xl",children:"Carregando..."})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:e.jsx("div",{className:"container mx-auto px-4 py-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-2 md:space-y-0",children:[e.jsx(r,{to:"/",className:"flex items-center",children:e.jsx("img",{src:"/logo B.png",alt:"Link de Cadastro",className:"h-20 md:h-24 w-auto object-contain"})}),e.jsxs("nav",{className:"flex items-center space-x-4 md:space-x-6 text-sm md:text-base",children:[e.jsx(r,{to:"/admin/dashboard",className:"text-gray-700 hover:text-[#FF6600]",children:"Dashboard"}),e.jsx(r,{to:"/admin/courses",className:"text-gray-700 hover:text-[#FF6600]",children:"Cursos"}),e.jsx(r,{to:"/admin/events",className:"text-gray-700 hover:text-[#FF6600]",children:"Eventos"}),e.jsx(F,{}),e.jsx(r,{to:"/profile",className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-[#FF6600] text-white font-bold flex items-center justify-center",children:c?.name?.charAt(0).toUpperCase()||"A"}),e.jsx("button",{onClick:()=>f(),className:"bg-red-500 text-white px-4 py-2 rounded-md font-semibold hover:bg-red-600 transition-colors text-sm md:text-base",children:"Sair"})]})]})})}),e.jsxs("div",{className:"container mx-auto px-4 py-8 pb-24 md:pb-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(r,{to:"/admin/courses",className:"text-[#FF6600] hover:underline mb-4 inline-block",children:"← Voltar para Cursos"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#003366] mb-2",children:"Inscritos no Curso"}),d&&e.jsx("p",{className:"text-gray-600 text-lg",children:d.title})]}),e.jsxs("button",{onClick:b,className:"bg-green-600 text-white px-6 py-3 rounded-md font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Exportar Excel"]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nº"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progresso"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data de Inscrição"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"Nenhum inscrito encontrado."})}):i.map((t,a)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a+1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.user.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.user.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2 mr-2",children:e.jsx("div",{className:"bg-[#FF6600] h-2 rounded-full transition-all",style:{width:`${t.progress}%`}})}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.progress,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:S(new Date(t.createdAt),"dd/MM/yyyy HH:mm",{locale:E})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.completedAt?e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Concluído"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",children:"Em Andamento"})})]},t.id))})]})})}),i.length>0&&e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:["Total de inscritos: ",e.jsx("strong",{children:i.length})]})]}),e.jsx(L,{})]})}export{O as default};
