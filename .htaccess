<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  
  # Remove barras duplas da URL primeiro
  RewriteCond %{REQUEST_URI} ^(.*)//(.*)$
  RewriteRule . %1/%2 [R=301,L]
  
  # Não reescrever arquivos físicos existentes (imagens, CSS, JS, etc)
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  
  # Não reescrever se for um arquivo estático
  RewriteCond %{REQUEST_URI} !\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|json|xml|txt|pdf|zip)$
  
  # Não reescrever requisições para API (se houver)
  RewriteCond %{REQUEST_URI} !^/api/
  
  # Redirecionar tudo para index.html (SPA)
  # Isso permite que o React Router gerencie todas as rotas no cliente
  RewriteRule ^(?!index\.html$).* /index.html [L]
</IfModule>

# Configuração adicional para garantir que index.html seja servido
DirectoryIndex index.html

# Prevenir listagem de diretórios
Options -Indexes

# Segurança: não permitir acesso a arquivos ocultos
<FilesMatch "^\.">
  Order allow,deny
  Deny from all
</FilesMatch>

# Configurações de cache para assets
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
</IfModule>

